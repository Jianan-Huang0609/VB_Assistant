<script src="https://cdn.tailwindcss.com"></script>
<style>
  .card { 
    box-shadow: 0 10px 15px -3px rgba(0,0,0,.1), 0 4px 6px -4px rgba(0,0,0,.1);
    transition: all 0.3s ease;
  }
  .hero-gradient {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  }
  .glass {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
  }
  .tech-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
  }
  .status-new { background: #dbeafe; color: #1e40af; }
  .status-progress { background: #fef3c7; color: #92400e; }
  .status-complete { background: #d1fae5; color: #065f46; }
  .status-archived { background: #f3f4f6; color: #6b7280; }
</style>

<section class="module-content">
  <!-- Hero Section -->
  <header class="hero-gradient text-white rounded-2xl mb-8">
    <div class="p-8 text-center">
      <h2 class="text-4xl md:text-5xl font-black mb-6">PoC-Tech</h2>
      <p class="text-xl mb-8 opacity-90">
        概念验证与技术路径探索平台
      </p>
      <div class="glass rounded-2xl p-6 max-w-3xl mx-auto">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-center">
          <div>
            <div class="text-3xl font-bold" id="totalPocs">0</div>
            <div class="text-sm opacity-80">总项目数</div>
          </div>
          <div>
            <div class="text-3xl font-bold" id="activePocs">0</div>
            <div class="text-sm opacity-80">进行中</div>
          </div>
          <div>
            <div class="text-3xl font-bold" id="completedPocs">0</div>
            <div class="text-sm opacity-80">已完成</div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Filter Bar -->
  <section class="bg-white/10 backdrop-blur border border-gray-700 rounded-xl p-4 mb-8 sticky top-0 z-40">
    <div class="flex flex-wrap gap-4 items-center">
      <div class="flex items-center space-x-2">
        <label class="text-sm font-medium text-gray-300">状态:</label>
        <select id="statusFilter" class="bg-gray-800 border border-gray-600 rounded px-3 py-1 text-gray-200">
          <option value="">全部状态</option>
          <option value="new">新建</option>
          <option value="progress">进行中</option>
          <option value="complete">已完成</option>
          <option value="archived">已归档</option>
        </select>
      </div>
      <div class="flex items-center space-x-2">
        <label class="text-sm font-medium text-gray-300">技术栈:</label>
        <select id="techFilter" class="bg-gray-800 border border-gray-600 rounded px-3 py-1 text-gray-200">
          <option value="">全部技术</option>
          <option value="vb.net">VB.NET</option>
          <option value="c#">C#</option>
          <option value="web">Web技术</option>
          <option value="database">数据库</option>
          <option value="ai">AI/ML</option>
        </select>
      </div>
      <div class="flex items-center space-x-2">
        <input type="text" id="searchInput" placeholder="搜索项目..." class="bg-gray-800 border border-gray-600 rounded px-3 py-1 w-64 text-gray-200">
      </div>
      <div class="ml-auto flex gap-2">
        <button id="newPocBtn" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-semibold transition-all">
          新建PoC
        </button>
        <button id="exportBtn" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-semibold transition-all">
          导出数据
        </button>
      </div>
    </div>
  </section>

  <!-- Main Content -->
  <main>
    <!-- PoC Grid -->
    <div id="pocGrid" class="tech-grid mb-8"></div>
    
    <!-- Empty State -->
    <div id="emptyState" class="text-center py-16 hidden">
      <svg class="w-24 h-24 mx-auto text-gray-500 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
      </svg>
      <h3 class="text-xl font-semibold mb-2 text-gray-300">还没有PoC项目</h3>
      <p class="text-gray-500 mb-4">开始创建你的第一个概念验证项目</p>
      <button onclick="showNewPocModal()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-semibold transition-all">
        创建新PoC
      </button>
    </div>
  </main>
</section>

<!-- New PoC Modal -->
<div id="newPocModal" class="fixed inset-0 bg-black/50 z-50 hidden">
  <div class="flex items-center justify-center min-h-screen p-4">
    <div class="bg-gray-800 text-gray-200 rounded-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto">
      <h3 class="text-2xl font-bold mb-6">创建新的PoC项目</h3>
      
      <form id="newPocForm" class="space-y-6">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium mb-2">项目名称 *</label>
            <input type="text" name="name" id="pocName" required class="w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-gray-200" placeholder="例如：VB.NET WinForms现代化改造">
          </div>
          <div>
            <label class="block text-sm font-medium mb-2">技术栈 *</label>
            <select name="tech" id="pocTech" required class="w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-gray-200">
              <option value="">选择主要技术</option>
              <option value="vb.net">VB.NET</option>
              <option value="c#">C#</option>
              <option value="web">Web技术</option>
              <option value="database">数据库</option>
              <option value="ai">AI/ML</option>
            </select>
          </div>
        </div>
        
        <div>
          <label class="block text-sm font-medium mb-2">概念描述 *</label>
          <textarea name="description" id="pocDescription" required class="w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 h-24 text-gray-200" placeholder="描述你要验证的技术概念或解决的问题..."></textarea>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium mb-2">预期时长</label>
            <select name="duration" id="pocDuration" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-gray-200">
              <option value="1-3">1-3天</option>
              <option value="1周">1周</option>
              <option value="2周">2周</option>
              <option value="1月">1个月</option>
              <option value="2月+">2个月以上</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium mb-2">优先级</label>
            <select name="priority" id="pocPriority" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-gray-200">
              <option value="低">低</option>
              <option value="中" selected>中</option>
              <option value="高">高</option>
              <option value="紧急">紧急</option>
            </select>
          </div>
        </div>
        
        <div>
          <label class="block text-sm font-medium mb-2">验证目标</label>
          <textarea name="goals" id="pocGoals" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 h-20 text-gray-200" placeholder="列出具体的验证目标和成功标准..."></textarea>
        </div>
        
        <div>
          <label class="block text-sm font-medium mb-2">相关资源链接</label>
          <input type="url" name="resources" id="pocResources" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-gray-200" placeholder="https://...">
        </div>
        
        <div class="flex justify-end space-x-4 pt-4">
          <button type="button" onclick="hideNewPocModal()" class="px-6 py-2 border border-gray-600 rounded-lg hover:bg-gray-700 transition-all">
            取消
          </button>
          <button type="submit" class="px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-all">
            创建PoC
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- PoC Detail Modal -->
<div id="pocDetailModal" class="fixed inset-0 bg-black/50 z-50 hidden">
  <div class="flex items-center justify-center min-h-screen p-4">
    <div class="bg-gray-800 text-gray-200 rounded-2xl p-8 max-w-4xl w-full max-h-[90vh] overflow-y-auto">
      <div class="flex items-center justify-between mb-6">
        <h3 id="detailTitle" class="text-2xl font-bold"></h3>
        <button onclick="hidePocDetailModal()" class="text-gray-500 hover:text-gray-300">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
      <div id="detailContent"></div>
    </div>
  </div>
</div>

<script>
  // PoC-Tech Module JavaScript
  (function() {
    // Data Storage
    let pocData = JSON.parse(localStorage.getItem('pocTechPath') || '[]');
    
    // Utility Functions
    function generateId() {
      return 'poc_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
    }
    
    function formatDate(date) {
      return new Date(date).toLocaleDateString('zh-CN');
    }
    
    function getStatusClass(status) {
      const classes = {
        'new': 'status-new',
        'progress': 'status-progress', 
        'complete': 'status-complete',
        'archived': 'status-archived'
      };
      return classes[status] || 'status-new';
    }
    
    function getStatusText(status) {
      const texts = {
        'new': '新建',
        'progress': '进行中',
        'complete': '已完成', 
        'archived': '已归档'
      };
      return texts[status] || '未知';
    }
    
    // Data Management
    function savePocData() {
      localStorage.setItem('pocTechPath', JSON.stringify(pocData));
      updateStats();
    }
    
    function updateStats() {
      const total = pocData.length;
      const active = pocData.filter(p => p.status === 'progress').length;
      const completed = pocData.filter(p => p.status === 'complete').length;
      
      const totalEl = document.getElementById('totalPocs');
      const activeEl = document.getElementById('activePocs');
      const completedEl = document.getElementById('completedPocs');
      
      if (totalEl) totalEl.textContent = total;
      if (activeEl) activeEl.textContent = active;
      if (completedEl) completedEl.textContent = completed;
    }
    
    // Modal Functions
    window.showNewPocModal = function() {
      document.getElementById('newPocModal').classList.remove('hidden');
    }
    
    window.hideNewPocModal = function() {
      document.getElementById('newPocModal').classList.add('hidden');
      document.getElementById('newPocForm').reset();
    }
    
    window.showPocDetailModal = function(pocId) {
      const poc = pocData.find(p => p.id === pocId);
      if (!poc) return;
      
      document.getElementById('detailTitle').textContent = poc.name;
      document.getElementById('detailContent').innerHTML = renderPocDetail(poc);
      document.getElementById('pocDetailModal').classList.remove('hidden');
    }
    
    window.hidePocDetailModal = function() {
      document.getElementById('pocDetailModal').classList.add('hidden');
    }
    
    // Rendering Functions
    function renderPocCard(poc) {
      return `
        <div class="card bg-gray-800 rounded-2xl p-6 hover:shadow-lg transition-all cursor-pointer border border-gray-700" onclick="showPocDetailModal('${poc.id}')">
          <div class="flex items-start justify-between mb-4">
            <h3 class="font-bold text-lg leading-tight text-gray-200">${poc.name}</h3>
            <span class="px-3 py-1 rounded-full text-xs font-medium ${getStatusClass(poc.status)}">
              ${getStatusText(poc.status)}
            </span>
          </div>
          
          <p class="text-gray-400 text-sm mb-4 line-clamp-3">${poc.description}</p>
          
          <div class="flex items-center justify-between text-xs text-gray-500 mb-4">
            <span class="bg-gray-700 px-2 py-1 rounded text-gray-300">${poc.tech}</span>
            <span>创建于 ${formatDate(poc.createdAt)}</span>
          </div>
          
          <div class="flex items-center justify-between">
            <div class="flex items-center space-x-2">
              <span class="text-xs text-gray-500">预期时长: ${poc.duration}</span>
            </div>
            <div class="flex items-center space-x-2">
              <button onclick="event.stopPropagation(); updatePocStatus('${poc.id}')" 
                      class="text-blue-400 hover:text-blue-300 text-xs">
                更新状态
              </button>
              <button onclick="event.stopPropagation(); deletePoc('${poc.id}')" 
                      class="text-red-400 hover:text-red-300 text-xs">
                删除
              </button>
            </div>
          </div>
        </div>
      `;
    }
    
    function renderPocDetail(poc) {
      return `
        <div class="space-y-6">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <h4 class="font-semibold mb-2">基本信息</h4>
              <div class="space-y-2 text-sm">
                <div><span class="text-gray-400">技术栈:</span> ${poc.tech}</div>
                <div><span class="text-gray-400">状态:</span> <span class="px-2 py-1 rounded ${getStatusClass(poc.status)} text-xs">${getStatusText(poc.status)}</span></div>
                <div><span class="text-gray-400">优先级:</span> ${poc.priority}</div>
                <div><span class="text-gray-400">预期时长:</span> ${poc.duration}</div>
                <div><span class="text-gray-400">创建时间:</span> ${formatDate(poc.createdAt)}</div>
              </div>
            </div>
            <div>
              <h4 class="font-semibold mb-2">项目描述</h4>
              <p class="text-sm text-gray-400">${poc.description}</p>
            </div>
          </div>
          
          ${poc.goals ? `
            <div>
              <h4 class="font-semibold mb-2">验证目标</h4>
              <p class="text-sm text-gray-400">${poc.goals}</p>
            </div>
          ` : ''}
          
          ${poc.resources ? `
            <div>
              <h4 class="font-semibold mb-2">相关资源</h4>
              <a href="${poc.resources}" target="_blank" class="text-blue-400 hover:text-blue-300 text-sm">${poc.resources}</a>
            </div>
          ` : ''}
          
          <div class="flex space-x-4 pt-4">
            <button onclick="updatePocStatus('${poc.id}')" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-semibold transition-all">
              更新状态
            </button>
            <button onclick="editPoc('${poc.id}')" class="px-4 py-2 border border-gray-600 hover:bg-gray-700 rounded-lg text-sm font-semibold transition-all">
              编辑项目
            </button>
            <button onclick="deletePoc('${poc.id}')" class="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg text-sm font-semibold transition-all">
              删除项目
            </button>
          </div>
        </div>
      `;
    }
    
    function renderPocs() {
      const grid = document.getElementById('pocGrid');
      const emptyState = document.getElementById('emptyState');
      
      if (!grid || !emptyState) return;
      
      // Apply filters
      let filteredPocs = pocData;
      
      const statusFilter = document.getElementById('statusFilter');
      const techFilter = document.getElementById('techFilter');
      const searchInput = document.getElementById('searchInput');
      
      if (statusFilter && statusFilter.value) {
        filteredPocs = filteredPocs.filter(p => p.status === statusFilter.value);
      }
      
      if (techFilter && techFilter.value) {
        filteredPocs = filteredPocs.filter(p => p.tech === techFilter.value);
      }
      
      if (searchInput && searchInput.value) {
        const searchText = searchInput.value.toLowerCase();
        filteredPocs = filteredPocs.filter(p => 
          p.name.toLowerCase().includes(searchText) || 
          p.description.toLowerCase().includes(searchText)
        );
      }
      
      // Sort by date (newest first)
      filteredPocs.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
      
      if (filteredPocs.length === 0) {
        grid.innerHTML = '';
        emptyState.classList.remove('hidden');
      } else {
        grid.innerHTML = filteredPocs.map(renderPocCard).join('');
        emptyState.classList.add('hidden');
      }
    }
    
    // CRUD Operations
    function createPoc(formData) {
      const poc = {
        id: generateId(),
        name: formData.get('name'),
        tech: formData.get('tech'),
        description: formData.get('description'),
        duration: formData.get('duration') || '1周',
        priority: formData.get('priority') || '中',
        goals: formData.get('goals') || '',
        resources: formData.get('resources') || '',
        status: 'new',
        createdAt: new Date().toISOString()
      };
      
      pocData.unshift(poc);
      savePocData();
      renderPocs();
      hideNewPocModal();
    }
    
    window.updatePocStatus = function(pocId) {
      const poc = pocData.find(p => p.id === pocId);
      if (!poc) return;
      
      const statuses = ['new', 'progress', 'complete', 'archived'];
      const currentIndex = statuses.indexOf(poc.status);
      const nextIndex = (currentIndex + 1) % statuses.length;
      
      poc.status = statuses[nextIndex];
      savePocData();
      renderPocs();
      hidePocDetailModal();
    }
    
    window.deletePoc = function(pocId) {
      if (!confirm('确定要删除这个PoC项目吗？')) return;
      
      pocData = pocData.filter(p => p.id !== pocId);
      savePocData();
      renderPocs();
      hidePocDetailModal();
    }
    
    window.editPoc = function(pocId) {
      alert('编辑功能开发中...');
    }
    
    function exportData() {
      const dataStr = JSON.stringify(pocData, null, 2);
      const dataBlob = new Blob([dataStr], {type: 'application/json'});
      const url = URL.createObjectURL(dataBlob);
      const link = document.createElement('a');
      link.href = url;
      link.download = 'poc-tech-path-data.json';
      link.click();
      URL.revokeObjectURL(url);
    }
    
    // Event Listeners
    function initEventListeners() {
      const newPocBtn = document.getElementById('newPocBtn');
      const exportBtn = document.getElementById('exportBtn');
      const newPocForm = document.getElementById('newPocForm');
      const statusFilter = document.getElementById('statusFilter');
      const techFilter = document.getElementById('techFilter');
      const searchInput = document.getElementById('searchInput');
      
      if (newPocBtn) newPocBtn.addEventListener('click', showNewPocModal);
      if (exportBtn) exportBtn.addEventListener('click', exportData);
      
      if (newPocForm) {
        newPocForm.addEventListener('submit', function(e) {
          e.preventDefault();
          const formData = new FormData(e.target);
          createPoc(formData);
        });
      }
      
      if (statusFilter) statusFilter.addEventListener('change', renderPocs);
      if (techFilter) techFilter.addEventListener('change', renderPocs);
      if (searchInput) searchInput.addEventListener('input', renderPocs);
    }
    
    // Initialize with sample data if empty
    function initSampleData() {
      if (pocData.length === 0) {
        pocData = [
          {
            id: generateId(),
            name: 'VB.NET WinForms现代化UI改造',
            tech: 'vb.net',
            description: '研究如何将传统VB.NET WinForms应用程序升级为现代化的UI界面，探索Material Design和Fluent Design的实现方案。',
            duration: '2周',
            priority: '高',
            goals: '1. 实现现代化的按钮和控件样式\n2. 添加动画和过渡效果\n3. 支持深色/浅色主题切换',
            resources: 'https://docs.microsoft.com/en-us/dotnet/desktop/winforms/',
            status: 'progress',
            createdAt: new Date(Date.now() - 86400000 * 5).toISOString()
          },
          {
            id: generateId(),
            name: 'Entity Framework Core with VB.NET',
            tech: 'database',
            description: '验证在VB.NET项目中使用Entity Framework Core的最佳实践，包括代码优先迁移和性能优化。',
            duration: '1周',
            priority: '中',
            goals: '1. 建立EF Core连接\n2. 实现CRUD操作\n3. 性能基准测试',
            resources: '',
            status: 'new',
            createdAt: new Date(Date.now() - 86400000 * 2).toISOString()
          }
        ];
        savePocData();
      }
    }
    
    // Initialize module
    function init() {
      initSampleData();
      updateStats();
      renderPocs();
      initEventListeners();
      console.log('PoC-Tech module initialized');
    }
    
    // Run initialization
    setTimeout(init, 100);
  })();
</script>
